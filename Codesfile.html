<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ملعب الأكواد | CyberAI OS</title>
  <link rel="stylesheet" href="https://krkr1o.github.io/open-aziz-ai/../style.css">
  <style>
    :root {
      --color-background: #0d0d0d;
      --color-foreground: #e60000;
      --color-primary: #ff1a1a;
      --color-secondary: #800000;
      --color-accent: #ff4d4d;
      --color-border: #333333;
      --color-card: #1a1a1a;
      --color-sidebar: #1a1a1a;
      --color-header: #1a1a1a;
    }

    body.theme-light {
      --color-background: #f8f8f8;
      --color-foreground: #222222;
      --color-primary: #e60000;
      --color-secondary: #800000;
      --color-accent: #ff4d4d;
      --color-border: #dddddd;
      --color-card: #ffffff;
      --color-sidebar: #ffffff;
      --color-header: #ffffff;
    }

    body.theme-cyberpunk {
      --color-background: #0a0a16;
      --color-foreground: #00ffff;
      --color-primary: #ff00ff;
      --color-secondary: #7700ff;
      --color-accent: #00ff00;
      --color-border: #333366;
      --color-card: #1a1a2e;
      --color-sidebar: #1a1a2e;
      --color-header: #1a1a2e;
    }

    body.theme-desert {
      --color-background: #f5e6cc;
      --color-foreground: #5e4b28;
      --color-primary: #c87137;
      --color-secondary: #8c5e28;
      --color-accent: #d4a76a;
      --color-border: #c8b99e;
      --color-card: #fff8e6;
      --color-sidebar: #fff8e6;
      --color-header: #fff8e6;
    }

    body {
      background-color: var(--color-background);
      color: var(--color-foreground);
    }

    header, footer {
      background-color: var(--color-header);
      border-bottom-color: var(--color-primary);
    }

    nav {
      background-color: var(--color-header);
      border-bottom-color: var(--color-secondary);
    }

    nav a {
      color: var(--color-primary);
    }

    nav a:hover {
      color: var(--color-accent);
    }

    .playground-container {
      display: flex;
      flex-direction: column;
      height: calc(100vh - 200px);
      max-width: 1200px;
      margin: 20px auto;
      gap: 20px;
    }

    .playground-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
      background-color: var(--color-card);
      border-radius: 10px;
      border: 1px solid var(--color-border);
    }

    .playground-controls {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .playground-controls select, .playground-controls button {
      padding: 8px 12px;
      background-color: var(--color-background);
      color: var(--color-foreground);
      border: 1px solid var(--color-border);
      border-radius: 5px;
    }

    .playground-controls button {
      background-color: var(--color-primary);
      color: white;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    .playground-controls button:hover {
      background-color: var(--color-accent);
    }

    .playground-main {
      display: flex;
      flex: 1;
      gap: 20px;
      height: 100%;
    }

    .playground-editor {
      flex: 1;
      border-radius: 10px;
      overflow: hidden;
      border: 1px solid var(--color-border);
    }

    .playground-output {
      flex: 1;
      display: flex;
      flex-direction: column;
      border-radius: 10px;
      overflow: hidden;
      border: 1px solid var(--color-border);
      background-color: var(--color-card);
    }

    .playground-output-header {
      padding: 10px;
      background-color: var(--color-secondary);
      color: white;
      font-weight: bold;
    }

    .playground-output-content {
      flex: 1;
      padding: 10px;
      overflow: auto;
      font-family: monospace;
      white-space: pre-wrap;
      background-color: var(--color-background);
    }

    .playground-output iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    .theme-toggle {
      display: flex;
      align-items: center;
      gap: 5px;
      cursor: pointer;
      padding: 5px 10px;
      border-radius: 5px;
      background-color: var(--color-background);
      border: 1px solid var(--color-border);
    }

    .theme-toggle svg {
      width: 20px;
      height: 20px;
    }

    @media (max-width: 768px) {
      .playground-main {
        flex-direction: column;
      }

      .playground-container {
        height: auto;
      }

      .playground-editor, .playground-output {
        height: 400px;
      }
    }
  </style>
    <link rel="stylesheet" href="https://krkr1o.github.io/open-aziz-ai/../assets/css/main.css">
</head>
<body data-page="codesfile">
  <header>
    <img src="https://krkr1o.github.io/open-aziz-ai/../images/logo_icon.png" alt="Logo" width="80">
    <h1>ملعب الأكواد</h1>
    <p>بيئة تطوير متكاملة مع دعم الذكاء الاصطناعي</p>
  </header>

  <nav>
    <a href="https://krkr1o.github.io/open-aziz-ai/../index.html">الرئيسية</a>
    <a href="https://krkr1o.github.io/open-aziz-ai/../dashboard.html">لوحة التحكم</a>
    <a href="https://krkr1o.github.io/open-aziz-ai/بوتات.html">بوتات الذكاء</a>
    <a href="https://krkr1o.github.io/open-aziz-ai/دردشة-GPT.html">دردشة GPT</a>
    <a href="https://krkr1o.github.io/open-aziz-ai/دردشة-متقدمة.html">دردشة متقدمة</a>
    <a href="https://krkr1o.github.io/open-aziz-ai/مساعد-أكواد.html">مساعد أكواد</a>
    <a href="https://krkr1o.github.io/open-aziz-ai/ملعب-الأكواد.html" class="active">ملعب الأكواد</a>
    <a href="https://krkr1o.github.io/open-aziz-ai/تصاميم.html">تصاميم</a>
    <a href="https://krkr1o.github.io/open-aziz-ai/نشر-مشاريع.html">نشر مشاريع</a>
    <a href="https://krkr1o.github.io/open-aziz-ai/المنتدى.html">المنتدى</a>
    <a href="https://krkr1o.github.io/open-aziz-ai/التوثيق.html">التوثيق</a>
    <a href="https://krkr1o.github.io/open-aziz-ai/اتصل-بنا.html">اتصل بنا</a>
  </nav>

  <div class="playground-container">
    <div class="playground-header">
      <div class="playground-controls">
        <select id="language-selector">
          <option value="javascript">JavaScript</option>
          <option value="typescript">TypeScript</option>
          <option value="html">HTML</option>
          <option value="css">CSS</option>
          <option value="json">JSON</option>
          <option value="python">Python</option>
          <option value="php">PHP</option>
          <option value="csharp">C#</option>
          <option value="java">Java</option>
          <option value="markdown">Markdown</option>
        </select>
        <button id="run-button">تشغيل الكود</button>
        <button id="save-button">حفظ</button>
        <button id="share-button">مشاركة</button>
        <button id="ai-assist-button">مساعدة الذكاء الاصطناعي</button>
      </div>
      <div class="theme-toggle" id="theme-toggle">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M12 2V4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M12 20V22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M4.93 4.93L6.34 6.34" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M17.66 17.66L19.07 19.07" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M2 12H4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M20 12H22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M6.34 17.66L4.93 19.07" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M19.07 4.93L17.66 6.34" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span>تبديل السمة</span>
      </div>
    </div>

    <div class="playground-main">
      <div class="playground-editor" id="code-editor"></div>
      <div class="playground-output">
        <div class="playground-output-header">النتيجة</div>
        <div class="playground-output-content" id="output-content"></div>
      </div>
    </div>
  </div>

  <footer>
    <p>تابع عبدالعزيز:</p>
    <p>
      <a href="https://krkr1o.github.io/open-aziz-ai/https://www.snapchat.com/add/bx90_9" target="_blank">Snapchat</a> |
      <a href="https://krkr1o.github.io/open-aziz-ai/https://www.instagram.com/3zooo6" target="_blank">Instagram</a> |
      <a href="https://krkr1o.github.io/open-aziz-ai/mailto:abdulzizsaleme@gmail.com">Email</a>
    </p>
    <p>© 2025 عبدالعزيز - جميع الحقوق محفوظة</p>
  </footer>

  <script src="https://krkr1o.github.io/open-aziz-ai/../js/auth.js"></script>
  <script src="https://krkr1o.github.io/open-aziz-ai/../js/secure-api.js"></script>
  <script src="https://krkr1o.github.io/open-aziz-ai/../js/secure-config.js"></script>
  <script src="https://krkr1o.github.io/open-aziz-ai/../js/database.js"></script>
  <script src="https://krkr1o.github.io/open-aziz-ai/../js/theme-manager.js"></script>
  <script src="https://krkr1o.github.io/open-aziz-ai/../js/code-editor.js"></script>
  
    <script src="https://krkr1o.github.io/open-aziz-ai/../scripts/main.js"></script>
</body>
</html>

```tsx file="js/project-manager.js"
/**
 * Project Manager
 * Handles project creation, management, and deployment
 */

class ProjectManager {
  constructor() {
    this.currentProject = null;
    this.projectListeners = [];
    this.templates = {
      web: {
        name: 'مشروع ويب',
        files: {
          'index.html': `<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>مشروع جديد</title>
  <link rel="stylesheet" href="https://krkr1o.github.io/open-aziz-ai/style.css">
    <link rel="stylesheet" href="https://krkr1o.github.io/open-aziz-ai/../assets/css/main.css">
</head>
<body data-page="codesfile">
  <h1>مرحباً بالعالم!</h1>
  <p>هذا هو مشروعي الجديد.</p>
  
  <script src="https://krkr1o.github.io/open-aziz-ai/script.js"></script>
    <script src="https://krkr1o.github.io/open-aziz-ai/../scripts/main.js"></script>
</body>
</html>`,
          'style.css': `body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  margin: 0;
  padding: 20px;
  background-color: #f8f8f8;
  color: #333;
}

h1 {
  color: #e60000;
}`,
          'script.js': `// كود جافاسكريبت
console.log('مرحباً بالعالم!');`
        }
      },
      react: {
        name: 'مشروع React',
        files: {
          'index.html': `<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>مشروع React</title>
    <link rel="stylesheet" href="https://krkr1o.github.io/open-aziz-ai/../assets/css/main.css">
</head>
<body data-page="codesfile">
  <div id="root"></div>
  
  <script src="https://krkr1o.github.io/open-aziz-ai/https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://krkr1o.github.io/open-aziz-ai/https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://krkr1o.github.io/open-aziz-ai/https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script type="text/babel" src="https://krkr1o.github.io/open-aziz-ai/app.js"></script>
    <script src="https://krkr1o.github.io/open-aziz-ai/../scripts/main.js"></script>
</body>
</html>`,
          'app.js': `// كود React
function App() {
  const [count, setCount] = React.useState(0);
  
  return (
    <div className="app">
      <h1>مرحباً بالعالم مع React!</h1>
      <p>عدد النقرات: {count}</p>
      <button onClick={() => setCount(count + 1)}>زيادة</button>
    </div>
  );
}

ReactDOM.render(<App />, document.getElementById('root'));`,
          'styles.css': `body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  margin: 0;
  padding: 20px;
  background-color: #f8f8f8;
  color: #333;
}

.app {
  max-width: 600px;
  margin: 0 auto;
  padding: 20px;
  background-color: white;
  border-radius: 10px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

button {
  background-color: #e60000;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 4px;
  cursor: pointer;
}

button:hover {
  background-color: #ff1a1a;
}`
        }
      },
      node: {
        name: 'مشروع Node.js',
        files: {
          'index.js': `// مشروع Node.js
const http = require('http');

const server = http.createServer((req, res) => {
  res.statusCode = 200;
  res.setHeader('Content-Type', 'text/html; charset=utf-8');
  res.end('<h1>مرحباً بالعالم من Node.js!</h1>');
});

const PORT = process.env.PORT || 3000;
server.listen(PORT, () => {
  console.log(\`الخادم يعمل على المنفذ \${PORT}\`);
});`,
          'package.json': `{
  "name": "node-project",
  "version": "1.0.0",
  "description": "مشروع Node.js",
  "main": "index.js",
  "scripts": {
    "start": "node index.js",
    "dev": "nodemon index.js"
  },
  "dependencies": {
    "express": "^4.18.2"
  },
  "devDependencies": {
    "nodemon": "^2.0.22"
  }
}`
        }
      }
    };
  }

  /**
   * Initialize the project manager
   */
  async init() {
    // Make sure auth and database are initialized
    await window.auth.init();
    await window.database.init();
    
    return true;
  }

  /**
   * Create a new project
   * @param {string} name - The project name
   * @param {string} template - The template to use
   */
  async createProject(name, template = 'web') {
    if (!window.auth.isAuthenticated()) {
      throw new Error('يجب تسجيل الدخول لإنشاء مشروع');
    }
    
    const userId = window.auth.getUserId();
    
    // Get template
    const templateData = this.templates[template];
    
    if (!templateData) {
      throw new Error(`القالب "${template}" غير موجود`);
    }
    
    // Create project
    const project = {
      id: 'proj_' + Math.random().toString(36).substring(2, 15),
      name,
      template,
      files: templateData.files,
      createdAt: new Date().toISOString(),
      updatedAt: new Date().toISOString()
    };
    
    // Save project
    await window.database.saveProject(userId, project);
    
    // Set current project
    this.currentProject = project;
    
    // Log activity
    window.database.logUserActivity(userId, 'project_created', { projectId: project.id, template });
    
    // Notify listeners
    this.notifyProjectListeners();
    
    return project;
  }

  /**
   * Load a project
   * @param {string} projectId - The project ID
   */
  async loadProject(projectId) {
    if (!window.auth.isAuthenticated()) {
      throw new Error('يجب تسجيل الدخول لتحميل مشروع');
    }
    
    const userId = window.auth.getUserId();
    
    // Get user projects
    const projects = await window.database.getUserProjects(userId);
    
    // Find project
    const project = projects[projectId];
    
    if (!project) {
      throw new Error(`المشروع "${projectId}" غير موجود`);
    }
    
    // Set current project
    this.currentProject = project;
    
    // Log activity
    window.database.logUserActivity(userId, 'project_loaded', { projectId });
    
    // Notify listeners
    this.notifyProjectListeners();
    
    return project;
  }

  /**
   * Save the current project
   */
  async saveProject() {
    if (!window.auth.isAuthenticated()) {
      throw new Error('يجب تسجيل الدخول لحفظ مشروع');
    }
    
    if (!this.currentProject) {
      throw new Error('لا يوجد مشروع مفتوح');
    }
    
    const userId = window.auth.getUserId();
    
    // Update project
    this.currentProject.updatedAt = new Date().toISOString();
    
    // Save project
    await window.database.saveProject(userId, this.currentProject);
    
    // Log activity
    window.database.logUserActivity(userId, 'project_saved', { projectId: this.currentProject.id });
    
    return this.currentProject;
  }

  /**
   * Update a file in the current project
   * @param {string} filePath - The file path
   * @param {string} content - The file content
   */
  async updateFile(filePath, content) {
    if (!this.currentProject) {
      throw new Error('لا يوجد مشروع مفتوح');
    }
    
    // Update file
    this.currentProject.files[filePath] = content;
    
    // Save project
    await this.saveProject();
    
    return true;
  }

  /**
   * Delete a file from the current project
   * @param {string} filePath - The file path
   */
  async deleteFile(filePath) {
    if (!this.currentProject) {
      throw new Error('لا يوجد مشروع مفتوح');
    }
    
    // Check if file exists
    if (!this.currentProject.files[filePath]) {
      throw new Error(`الملف "${filePath}" غير موجود`);
    }
    
    // Delete file
    delete this.currentProject.files[filePath];
    
    // Save project
    await this.saveProject();
    
    return true;
  }

  /**
   * Add a file to the current project
   * @param {string} filePath - The file path
   * @param {string} content - The file content
   */
  async addFile(filePath, content = '') {
    if (!this.currentProject) {
      throw new Error('لا يوجد مشروع مفتوح');
    }
    
    // Check if file already exists
    if (this.currentProject.files[filePath]) {
      throw new Error(`الملف "${filePath}" موجود بالفعل`);
    }
    
    // Add file
    this.currentProject.files[filePath] = content;
    
    // Save project
    await this.saveProject();
    
    return true;
  }

  /**
   * Rename a file in the current project
   * @param {string} oldPath - The old file path
   * @param {string} newPath - The new file path
   */
  async renameFile(oldPath, newPath) {
    if (!this.currentProject) {
      throw new Error('لا يوجد مشروع مفتوح');
    }
    
    // Check if old file exists
    if (!this.currentProject.files[oldPath]) {
      throw new Error(`الملف "${oldPath}" غير موجود`);
    }
    
    // Check if new file already exists
    if (this.currentProject.files[newPath]) {
      throw new Error(`الملف "${newPath}" موجود بالفعل`);
    }
    
    // Rename file
    this.currentProject.files[newPath] = this.currentProject.files[oldPath];
    delete this.currentProject.files[oldPath];
    
    // Save project
    await this.saveProject();
    
    return true;
  }

  /**
   * Get all user projects
   */
  async getUserProjects() {
    if (!window.auth.isAuthenticated()) {
      return {};
    }
    
    const userId = window.auth.getUserId();
    
    return window.database.getUserProjects(userId);
  }

  /**
   * Delete a project
   * @param {string} projectId - The project ID
   */
  async deleteProject(projectId) {
    if (!window.auth.isAuthenticated()) {
      throw new Error('يجب تسجيل الدخول لحذف مشروع');
    }
    
    const userId = window.auth.getUserId();
    
    // Delete project
    await window.database.saveData(`projects/${userId}/${projectId}`, null);
    
    // If current project is deleted, set to null
    if (this.currentProject && this.currentProject.id === projectId) {
      this.currentProject = null;
      this.notifyProjectListeners();
    }
    
    // Log activity
    window.database.logUserActivity(userId, 'project_deleted', { projectId });
    
    return true;
  }

  /**
   * Export a project as a ZIP file
   * @param {string} projectId - The project ID
   */
  async exportProject(projectId) {
    if (!window.auth.isAuthenticated()) {
      throw new Error('يجب تسجيل الدخول لتصدير مشروع');
    }
    
    // Load project if not current
    let project;
    if (this.currentProject && this.currentProject.id === projectId) {
      project = this.currentProject;
    } else {
      project = await this.loadProject(projectId);
    }
    
    // Create a blob with project data
    const projectData = JSON.stringify(project, null, 2);
    const blob = new Blob([projectData], { type: 'application/json' });
    
    // Create download link
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `${project.name}.json`;
    
    // Trigger download
    document.body.appendChild(a);
    a.click();
    
    // Clean up
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    
    // Log activity
    const userId = window.auth.getUserId();
    window.database.logUserActivity(userId, 'project_exported', { projectId });
    
    return true;
  }

  /**
   * Import a project from a file
   * @param {File} file - The project file
   */
  async importProject(file) {
    if (!window.auth.isAuthenticated()) {
      throw new Error('يجب تسجيل الدخول لاستيراد مشروع');
    }
    
    return new Promise((resolve, reject) => {
      const reader = new FileReader();
      
      reader.onload = async (e) => {
        try {
          const projectData = JSON.parse(e.target.result);
          
          // Validate project data
          if (!projectData.name || !projectData.files) {
            throw new Error('ملف المشروع غير صالح');
          }
          
          // Create new project ID
          projectData.id = 'proj_' + Math.random().toString(36).substring(2, 15);
          
          // Set timestamps
          projectData.importedAt = new Date().toISOString();
          projectData.createdAt = projectData.createdAt || new Date().toISOString();
          projectData.updatedAt = new Date().toISOString();
          
          // Save project
          const userId = window.auth.getUserId();
          await window.database.saveProject(userId, projectData);
          
          // Set as current project
          this.currentProject = projectData;
          
          // Log activity
          window.database.logUserActivity(userId, 'project_imported', { projectId: projectData.id });
          
          // Notify listeners
          this.notifyProjectListeners();
          
          resolve(projectData);
        } catch (error) {
          reject(error);
        }
      };
      
      reader.onerror = () => {
        reject(new Error('فشل قراءة الملف'));
      };
      
      reader.readAsText(file);
    });
  }

  /**
   * Deploy a project to Vercel
   * @param {string} projectId - The project ID
   */
  async deployProject(projectId) {
    if (!window.auth.isAuthenticated()) {
      throw new Error('يجب تسجيل الدخول لنشر مشروع');
    }
    
    // Load project if not current
    let project;
    if (this.currentProject && this.currentProject.id === projectId) {
      project = this.currentProject;
    } else {
      project = await this.loadProject(projectId);
    }
    
    // Check if Vercel integration is available
    const vercelConfig = await window.secureConfig.get('vercelConfig');
    
    if (!vercelConfig) {
      throw new Error('تكامل Vercel غير متاح');
    }
    
    // Prepare project for deployment
    const deploymentData = {
      name: project.name.toLowerCase().replace(/\s+/g, '-'),
      files: project.files,
      projectId: project.id
    };
    
    // Call deployment API
    try {
      const response = await fetch('/api/deploy', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(deploymentData)
      });
      
      if (!response.ok) {
        const error = await response.json();
        throw new Error(error.message || 'فشل نشر المشروع');
      }
      
      const deployment = await response.json();
      
      // Update project with deployment info
      project.deployments = project.deployments || [];
      project.deployments.push({
        id: deployment.id,
        url: deployment.url,
        createdAt: new Date().toISOString()
      });
      
      // Save project
      await this.saveProject();
      
      // Log activity
      const userId = window.auth.getUserId();
      window.database.logUserActivity(userId, 'project_deployed', { 
        projectId: project.id,
        deploymentId: deployment.id,
        deploymentUrl: deployment.url
      });
      
      return deployment;
    } catch (error) {
      console.error('Deployment error:', error);
      throw new Error('فشل نشر المشروع: ' + error.message);
    }
  }

  /**
   * Add a project listener
   * @param {Function} listener - The listener function
   */
  onProjectChanged(listener) {
    this.projectListeners.push(listener);
    
    // Call the listener immediately with the current project
    if (listener) {
      listener(this.currentProject);
    }
    
    // Return a function to remove the listener
    return () => {
      this.projectListeners = this.projectListeners.filter(l => l !== listener);
    };
  }

  /**
   * Notify all project listeners
   */
  notifyProjectListeners() {
    this.projectListeners.forEach(listener => {
      if (listener) {
        listener(this.currentProject);
      }
    });
  }

  /**
   * Get available templates
   */
  getTemplates() {
    return this.templates;
  }

  /**
   * Add a custom template
   * @param {string} id - The template ID
   * @param {string} name - The template name
   * @param {Object} files - The template files
   */
  addTemplate(id, name, files) {
    if (this.templates[id]) {
      throw new Error(`القالب "${id}" موجود بالفعل`);
    }
    
    this.templates[id] = {
      name,
      files
    };
    
    return this.templates[id];
  }
}

// Create a singleton instance
const projectManager = new ProjectManager();

// Export the instance
window.projectManager = projectManager;

// Initialize project manager when the DOM is loaded
document.addEventListener("DOMContentLoaded", () => {
  projectManager.init().then(success => {
    console.log('Project manager initialization:', success ? 'successful' : 'failed');
  });
});

